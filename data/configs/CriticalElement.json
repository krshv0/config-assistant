{
  "repo_name": "CriticalElement",
  "structure": {
    "sketchybarrc": {
      "path": "sketchybarrc",
      "language": "bash",
      "dependencies": [],
      "content": "BLUE=0xFF1E6E77\nORANGE=0xFFCC7B6E\nPINK=0xFFD7448A\nRED=0xFFCE3A5B\nGREEN=0xFF638989\n\n# main bar & defaults\nsketchybar --bar height=54        \\\n                 margin=12        \\\n                 y_offset=0       \\\n                 padding_left=0   \\\n                 padding_right=0  \\\n                 color=0x00000000\n\nsketchybar --default updates=when_shown                             \\\n                     icon.font=\"Liga SFMono Nerd Font:Normal:14.0\"  \\\n                     icon.color=0xFFFFFFFF                          \\\n                     label.font=\"Liga SFMono Nerd Font:Normal:14.0\" \\\n                     background.color=0x00000000                    \\\n                     y_offset=0\n\n# ~~ left items ~~\n\n# space numbers\nSPACE_ICONS=(\"1\" \"2\" \"3\" \"4\" \"5\" \"6\" \"7\" \"8\" \"9\" \"10\")\nSPACES=()\n\nfor i in \"${!SPACE_ICONS[@]}\"\ndo\n  sid=$(($i+1))\n  SPACES+=(space.$sid)\n  sketchybar --add space space.$sid left \\\n             --set space.$sid associated_space=$sid \\\n                              icon=${SPACE_ICONS[i]} \\\n                              icon.highlight_color=0xFFFFFFFF \\\n                              icon.align=center \\\n                              icon.width=30 \\\n                              label.drawing=off \\\n                              click_script=\"yabai -m space --focus $sid\"\ndone\n\n# create new space button\nsketchybar --add item new_space left                        \\\n           --set      new_space icon.width=24               \\\n                                label.padding_right=2       \\\n                                icon.align=center           \\\n                                icon.padding_right=2        \\\n                                icon=+                      \\\n                                click_script='./scripts/new_space.sh'\n\n# consolidate space numbers and add a background\nsketchybar --add bracket spaces '/space\\..*/' new_space                \\\n           --set         spaces background.color=0xEB1e1e2e            \\\n                                background.corner_radius=15            \\\n                                background.border_width=1              \\\n                                background.border_color=$PINK          \\\n                                blur_radius=2                          \\\n                                background.height=30                    \n\n# add space highlighter dot\nsketchybar --add item highlight_space left                      \\\n           --set      highlight_space width=22                  \\\n                                      background.color=$PINK    \\\n                                      background.height=22      \\\n                                      background.corner_radius=11 \\\n                                      script='./scripts/highlight_space.sh'\n\nsketchybar --subscribe highlight_space space_change\n\n# overlay numbers above space highlighter dot\nfor i in \"${!SPACE_ICONS[@]}\"\ndo\n  sid=$(($i+1))\n  SPACES+=(space.$sid)\n  sketchybar --add space space_ex.$sid left \\\n             --set space_ex.$sid associated_space=$sid \\\n                              icon=${SPACE_ICONS[i]} \\\n                              icon.highlight_color=0xFFFFFFFF \\\n                              icon.align=center \\\n                              icon.width=30 \\\n                              label.drawing=off \\\n                              click_script=\"yabai -m space --focus $sid\" \ndone\n\nsketchybar --set space_ex.1 padding_left=-999999\n\n# update defaults\nsketchybar --default                                                \\\n                     background.color=0xEB1e1e2e                    \\\n                     blur_radius=2                                  \\\n                     background.corner_radius=15                    \\\n                     background.height=30                           \\\n                     icon.padding_left=12                           \\\n                     icon.padding_right=4                           \\\n                     label.padding_left=4                           \\\n                     label.padding_right=12                         \\\n                     background.padding_left=18                     \\\n                     background.border_width=1\n\n\n# ~~ center items ~~\n\n# app title\nsketchybar --add event title_change\nsketchybar --add item title center                                  \\\n           --set      title label.padding_left=12                   \\\n                            label=\"Title\"                           \\\n                            background.padding_left=0               \\\n                            icon.padding_left=0                     \\\n                            icon.padding_right=0                    \\\n                            script='./scripts/title.sh'             \\\n                            background.border_color=0xFFD3CDC5      \\\n                            update_freq=1                           \\\n                            label.max_chars=54                      # \\\n                            # scroll_texts=on                         \\\n                            # label.scroll_duration=200\n\nsketchybar --subscribe title title_change\n\n\n# ~~ right items ~~\n\n# time\nsketchybar --add item time right                                    \\\n           --set      time icon=\udb85\udc4e                                   \\\n                           icon.color=$BLUE                       \\\n                           background.border_color=$BLUE          \\\n                           label=\"$(date '+%I:%M %p')\"              \\\n                           script='./scripts/time.sh'               \\\n                           update_freq=1\n\n# date\nsketchybar --add item date right                                    \\\n           --set      date icon=\udb86\ude30                                   \\\n                           icon.color=$GREEN                        \\\n                           background.border_color=$GREEN            \\\n                           label=\"$(date '+%a %b %d')\"              \\\n                           script='./scripts/date.sh'               \\\n                           update_freq=10\n\n# weather\nsketchybar --add item weather right                                 \\\n           --set      weather icon=A                                \\\n                              icon.color=$ORANGE                    \\\n                              background.border_color=$ORANGE       \\\n                              label=\"--\u00b0F\"                          \\\n                              script='./scripts/weather.sh'         \\\n                              update_freq=60\n\n# battery\nsketchybar --add item battery right                                 \\\n           --set      battery icon=\uf240                                \\\n                              icon.color=$RED                   \\\n                              background.border_color=$RED       \\\n                              label=\"--%\"                           \\\n                              script='./scripts/battery.sh'         \\\n                              update_freq=20\n\n\nsketchybar --add item title_proxy right                             \\\n           --set      title_proxy y_offset=100                      \\\n                                  label=\"Title\"\n\n\n# finish config\nsketchybar --hotload on\nsketchybar --update",
      "purpose": "",
      "content_summary": ""
    },
    "scripts/new_space.sh": {
      "path": "scripts/new_space.sh",
      "language": "bash",
      "dependencies": [],
      "content": "yabai -m space --create && \\\n    index=\"$(yabai -m query --spaces --display | jq 'map(select(.\"is-native-fullscreen\" == false))[-1].index')\" && \\\n    yabai -m space --focus \"${index}\"",
      "purpose": "",
      "content_summary": ""
    },
    "scripts/title.sh": {
      "path": "scripts/title.sh",
      "language": "bash",
      "dependencies": [],
      "content": "TITLE=$(yabai -m query --windows --window)\nif [ \"$TITLE\" = \"\" ]; then\n    sketchybar --set title_proxy label=\"\"\n    sketchybar --animate circ 15 --set title y_offset=70\n    sketchybar --set title label=\"\"\nelse\n    LABEL=\"$(echo $TITLE | jq -r '.title')\"\n    if [ \"$LABEL\" = \"\" ]; then\n        LABEL=\"$(echo $TITLE | jq -r '.app')\"\n    fi\n    if [ \"$(sketchybar --query title_proxy | jq -r '.label.value')\" != \"$LABEL\" ]; then\n        sketchybar --set title_proxy label=\"$LABEL\"\n        sketchybar --animate circ 15 --set title y_offset=70            \\\n                   --animate circ 10  --set title y_offset=7            \\\n                   --animate circ 15 --set title y_offset=0\n        \n        sketchybar --set title label=\"$LABEL\"\n    fi\nfi",
      "purpose": "",
      "content_summary": ""
    },
    "scripts/highlight_space.sh": {
      "path": "scripts/highlight_space.sh",
      "language": "bash",
      "dependencies": [],
      "content": "SID=$(echo $INFO | jq .[\\\"display-1\\\"])\nif [ \"$SID\" = \"\" ]; then\n    SID=$(yabai -m query --spaces --space | jq '.index')\nfi\nLENGTH=$($(echo yabai -m query --spaces) | jq length)\nsketchybar --animate circ 15 --set highlight_space background.padding_left=$((-(LENGTH - (SID - 2)) * 30 + 7))",
      "purpose": "",
      "content_summary": ""
    },
    "scripts/date.sh": {
      "path": "scripts/date.sh",
      "language": "bash",
      "dependencies": [],
      "content": "sketchybar --set date label=\"$(date '+%a %b %d')\"",
      "purpose": "",
      "content_summary": ""
    },
    "scripts/time.sh": {
      "path": "scripts/time.sh",
      "language": "bash",
      "dependencies": [],
      "content": "sketchybar --set time label=\"$(date '+%I:%M %p')\"",
      "purpose": "",
      "content_summary": ""
    },
    "scripts/battery.sh": {
      "path": "scripts/battery.sh",
      "language": "bash",
      "dependencies": [],
      "content": "# adapted from https://github.com/neutonfoo/dotfiles/blob/main/.config/sketchybar/plugins-laptop/battery.sh\n\nPERCENTAGE=$(pmset -g batt | grep -Eo \"\\d+%\" | cut -d% -f1)\nCHARGING=$(pmset -g batt | grep 'AC Power')\n\nif [ $PERCENTAGE = \"\" ]; then\n    exit 0\nfi\n\ncase ${PERCENTAGE} in\n[8-9][0-9] | 100)\n    ICON=\"\uf240\"\n    ;;\n7[0-9])\n    ICON=\"\uf241\"\n    ;;\n[4-6][0-9])\n    ICON=\"\uf242\"\n    ;;\n[1-3][0-9])\n    ICON=\"\uf243\"\n    ;;\n[0-9])\n    ICON=\"\uf244\"\n    ;;\nesac\n\nif [[ $CHARGING != \"\" ]]; then\n    ICON=\"\uf0e7\"\nfi\n\nsketchybar --set battery \\\n    icon=$ICON \\\n    label=\"${PERCENTAGE}%\"",
      "purpose": "",
      "content_summary": ""
    },
    "scripts/weather.sh": {
      "path": "scripts/weather.sh",
      "language": "bash",
      "dependencies": [
        "./scripts/weather.env.sh"
      ],
      "content": "# adapted from https://github.com/weirane/dotfiles/blob/macos/dotconfig/sketchybar/plugins/weather.sh\n\nget_icon() {\nif [[ $is_day == 1 ]]; then\n    case $code in\n        1000) icon=\ue30d ;; # Sunny, Clear/113\n        1003) icon=\ue302 ;; # Partly cloudy/116\n        1006) icon=\ue312 ;; # Cloudy/119\n        1009) icon=\ue302 ;; # Overcast/122\n        1030) icon=\ue303 ;; # Mist/143\n        1063) icon=\ue308 ;; # Patchy rain possible/176\n        1066) icon=\ue30a ;; # Patchy snow possible/179\n        1069) icon=\ue3aa ;; # Patchy sleet possible/182\n        1072) icon=\ue308 ;; # Patchy freezing drizzle possible/185\n        1087) icon=\ue30f ;; # Thundery outbreaks possible/200\n        1114) icon=\ue30a ;; # Blowing snow/227\n        1117) icon=\ue30a ;; # Blizzard/230\n        1135) icon=\ue303 ;; # Fog/248\n        1147) icon=\ue303 ;; # Freezing fog/260\n        1150) icon=\ue308 ;; # Patchy light drizzle/263\n        1153) icon=\ue308 ;; # Light drizzle/266\n        1168) icon=\ue308 ;; # Freezing drizzle/281\n        1171) icon=\ue308 ;; # Heavy freezing drizzle/284\n        1180) icon=\ue308 ;; # Patchy light rain/293\n        1183) icon=\ue308 ;; # Light rain/296\n        1186) icon=\ue308 ;; # Moderate rain at times/299\n        1189) icon=\ue308 ;; # Moderate rain/302\n        1192) icon=\ue308 ;; # Heavy rain at times/305\n        1195) icon=\ue308 ;; # Heavy rain/308\n        1198) icon=\ue308 ;; # Light freezing rain/311\n        1201) icon=\ue308 ;; # Moderate or heavy freezing rain/314\n        1204) icon=\ue3aa ;; # Light sleet/317\n        1207) icon=\ue3aa ;; # Moderate or heavy sleet/320\n        1210) icon=\ue30a ;; # Patchy light snow/323\n        1213) icon=\ue30a ;; # Light snow/326\n        1216) icon=\ue30a ;; # Patchy moderate snow/329\n        1219) icon=\ue30a ;; # Moderate snow/332\n        1222) icon=\ue30a ;; # Patchy heavy snow/335\n        1225) icon=\ue30a ;; # Heavy snow/338\n        1237) icon=\ue304 ;; # Ice pellets/350\n        1240) icon=\ue309 ;; # Light rain shower/353\n        1243) icon=\ue309 ;; # Moderate or heavy rain shower/356\n        1246) icon=\ue309 ;; # Torrential rain shower/359\n        1249) icon=\ue3aa ;; # Light sleet showers/362\n        1252) icon=\ue3aa ;; # Moderate or heavy sleet showers/365\n        1255) icon=\ue30a ;; # Light snow showers/368\n        1258) icon=\ue30a ;; # Moderate or heavy snow showers/371\n        1261) icon=\ue304 ;; # Light showers of ice pellets/374\n        1264) icon=\ue304 ;; # Moderate or heavy showers of ice pellets/377\n        1273) icon=\ue30f ;; # Patchy light rain with thunder/386\n        1276) icon=\ue30f ;; # Moderate or heavy rain with thunder/389\n        1279) icon=\ue367 ;; # Patchy light snow with thunder/392\n        1282) icon=\ue367 ;; # Moderate or heavy snow with thunder/395\n    esac\nelse\n    case $code in\n        1000) icon=\ue32b ;; # Sunny, Clear/113\n        1003) icon=\ue379 ;; # Partly cloudy/116\n        1006) icon=\ue312 ;; # Cloudy/119\n        1009) icon=\ue379 ;; # Overcast/122\n        1030) icon=\ue346 ;; # Mist/143\n        1063) icon=\ue325 ;; # Patchy rain possible/176\n        1066) icon=\ue327 ;; # Patchy snow possible/179\n        1069) icon=\ue3ac ;; # Patchy sleet possible/182\n        1072) icon=\ue325 ;; # Patchy freezing drizzle possible/185\n        1087) icon=\ue32a ;; # Thundery outbreaks possible/200\n        1114) icon=\ue327 ;; # Blowing snow/227\n        1117) icon=\ue327 ;; # Blizzard/230\n        1135) icon=\ue346 ;; # Fog/248\n        1147) icon=\ue346 ;; # Freezing fog/260\n        1150) icon=\ue325 ;; # Patchy light drizzle/263\n        1153) icon=\ue325 ;; # Light drizzle/266\n        1168) icon=\ue325 ;; # Freezing drizzle/281\n        1171) icon=\ue325 ;; # Heavy freezing drizzle/284\n        1180) icon=\ue325 ;; # Patchy light rain/293\n        1183) icon=\ue325 ;; # Light rain/296\n        1186) icon=\ue325 ;; # Moderate rain at times/299\n        1189) icon=\ue325 ;; # Moderate rain/302\n        1192) icon=\ue325 ;; # Heavy rain at times/305\n        1195) icon=\ue325 ;; # Heavy rain/308\n        1198) icon=\ue325 ;; # Light freezing rain/311\n        1201) icon=\ue325 ;; # Moderate or heavy freezing rain/314\n        1204) icon=\ue3ac ;; # Light sleet/317\n        1207) icon=\ue3ac ;; # Moderate or heavy sleet/320\n        1210) icon=\ue327 ;; # Patchy light snow/323\n        1213) icon=\ue327 ;; # Light snow/326\n        1216) icon=\ue327 ;; # Patchy moderate snow/329\n        1219) icon=\ue327 ;; # Moderate snow/332\n        1222) icon=\ue327 ;; # Patchy heavy snow/335\n        1225) icon=\ue327 ;; # Heavy snow/338\n        1237) icon=\ue321 ;; # Ice pellets/350\n        1240) icon=\ue334 ;; # Light rain shower/353\n        1243) icon=\ue334 ;; # Moderate or heavy rain shower/356\n        1246) icon=\ue334 ;; # Torrential rain shower/359\n        1249) icon=\ue3ac ;; # Light sleet showers/362\n        1252) icon=\ue3ac ;; # Moderate or heavy sleet showers/365\n        1255) icon=\ue327 ;; # Light snow showers/368\n        1258) icon=\ue327 ;; # Moderate or heavy snow showers/371\n        1261) icon=\ue321 ;; # Light showers of ice pellets/374\n        1264) icon=\ue321 ;; # Moderate or heavy showers of ice pellets/377\n        1273) icon=\ue32a ;; # Patchy light rain with thunder/386\n        1276) icon=\ue32a ;; # Moderate or heavy rain with thunder/389\n        1279) icon=\ue367 ;; # Patchy light snow with thunder/392\n        1282) icon=\ue367 ;; # Moderate or heavy snow with thunder/395\n    esac\nfi\n}\n\nAPI=\"https://api.weatherapi.com/v1/current.json\"\n# get KEY and CITY from the config file\nsource ./scripts/weather.env.sh\n\nfor i in {1..4}; do\n    weather=$(curl -sf --retry 3 \"$API?key=$KEY&q=$CITY\")\n    if [[ -z $weather || $(echo $weather | jq -r \".current\") == '{}' ]]; then\n        echo \"[WARNING] [$(gdate --iso-8601=seconds)] Weather API request failed $(echo $weather | jq -r \".current\")\" >&2\n        if ((i == 4)); then\n            echo \"[ERROR] [$(gdate --iso-8601=seconds)] Weather API request failed 4 times\" >&2\n            exit 0\n        fi\n        sleep 10\n    else\n        break\n    fi\ndone\n\ntemp=$(echo \"$weather\" | jq -r \".current.temp_f\")\nis_day=$(echo $weather | jq -r \".current.is_day\")\ncode=$(echo \"$weather\" | jq -r \".current.condition.code\")\nget_icon\ncity=$(echo \"$weather\" | jq -r \".location.name\")\ncondition=$(echo \"$weather\" | jq -r \".current.condition.text\")\nfeelslike=$(echo \"$weather\" | jq -r \".current.feelslike_f\")\nuv=$(echo \"$weather\" | jq -r \".current.uv\")\nhumidity=$(echo \"$weather\" | jq -r \".current.humidity\")\nwind_speed=$(echo \"$weather\" | jq -r \".current.wind_kph\")\nwind_direction=$(echo \"$weather\" | jq -r \".current.wind_dir\")\n\nsketchybar --set $NAME drawing=on icon=$icon label=\"${temp%%.*}\u00b0F\" # \\\n        #    --set weather.location label=\"Location: $city\" \\\n        #    --set weather.condition label=\"Condition: $condition\" \\\n        #    --set weather.feels_like label=\"Feels Like: $feelslike\u00b0F\" \\\n        #    --set weather.uv label=\"UV Index: $uv\" \\\n        #    --set weather.humidity label=\"Humidity: $humidity%\" \\\n        #    --set weather.wind label=\"Wind: $wind_speed km/h $wind_direction\" \\\n        #    --set weather.lastupdated label=\"Last Updated: $(gdate +%T)\"",
      "purpose": "",
      "content_summary": ""
    }
  }
}